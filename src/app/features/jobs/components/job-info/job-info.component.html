<div *ngIf="isLoading" class="h-100 d-flex flex-column align-items-center justify-content-center p-5 opacity-50">
    <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
</div>

<div *ngIf="job && !isLoading" class="h-100 d-flex flex-column bg-white overflow-auto scroll-slim-premium">
    <!-- Ultra-Compact Detail Header -->
    <div class="p-3 border-bottom shadow-sm">
        <div class="d-flex align-items-start gap-3 mb-2">
            <img [src]="'https://api.dicebear.com/7.x/initials/svg?seed=' + job.company_name" [alt]="job.company_name"
                class="rounded border shadow-xs"
                style="width: 48px; height: 48px; object-fit: contain; background: #f8f9fa;">
            <div class="flex-grow-1 min-width-0">
                <h5 class="fw-bold mb-0 text-dark text-truncate" style="font-size: 1.125rem;">{{ job.title }}</h5>
                <div class="d-flex align-items-center flex-wrap gap-2 x-small-text-premium mt-1">
                    <span class="text-primary fw-bold cursor-pointer">{{ job.company_name }}</span>
                    <span class="text-muted">·</span>
                    <span class="text-muted">{{ job.location }}</span>
                </div>
            </div>
            <div class="d-flex gap-1">
                <button class="btn btn-icon-premium"><lucide-icon name="share-2" [size]="14"></lucide-icon></button>
                <button class="btn btn-icon-premium"><lucide-icon name="bookmark" [size]="14"></lucide-icon></button>
            </div>
        </div>

        <div class="d-flex flex-wrap gap-1 mb-3">
            <span class="badge-premium" *ngIf="job.remote">
                <lucide-icon name="monitor" [size]="12"></lucide-icon> Télétravail
            </span>
            <span class="badge-premium" *ngFor="let type of job.job_types">
                <lucide-icon name="clock" [size]="12"></lucide-icon> {{ type }}
            </span>
            <span class="badge-premium text-success border-success-subtle" style="background: #e6f4ea;">
                <lucide-icon name="users" [size]="12"></lucide-icon> +100 candidats
            </span>
        </div>

        <div class="d-flex gap-2">
            <button class="btn btn-primary btn-sm px-4 fw-bold rounded-pill shadow-sm d-flex align-items-center gap-2">
                <lucide-icon name="zap" [size]="14"></lucide-icon> Candidature
            </button>
            <button class="btn btn-outline-secondary btn-sm px-4 fw-bold rounded-pill">Enregistrer</button>
        </div>
    </div>

    <!-- High-Density Content Area -->
    <div class="p-3 bg-light bg-opacity-25">
        <!-- Premium Insight (Compact) -->
        <div class="insight-premium-card p-2 px-3 border rounded-3 mb-3 d-flex align-items-center gap-3 shadow-sm">
            <div class="insight-icon-box shadow-sm">
                <lucide-icon name="trending-up" [size]="16" class="text-warning"></lucide-icon>
            </div>
            <div class="flex-grow-1">
                <p class="mb-0 x-small-text-premium fw-bold text-dark">Aperçu Candidat Premium</p>
                <p class="mb-0 xx-small-text text-muted">Comparez votre profil à +100 candidats.</p>
            </div>
            <button
                class="btn btn-link btn-sm p-0 x-small-text-premium fw-bold text-warning text-decoration-none">Essayer</button>
        </div>

        <div class="mb-4">
            <h6 class="fw-bold x-small-text-premium text-uppercase letter-spacing-1 text-muted mb-2">Description du
                poste</h6>
            <div class="job-description-modern lh-sm" [innerHTML]="job.description"></div>
        </div>

        <!-- Expertise Section -->
        <div class="border-top pt-3">
            <h6 class="fw-bold x-small-text-premium text-uppercase letter-spacing-1 text-muted mb-2">Compétences
                recherchées</h6>
            <div class="d-flex flex-wrap gap-1">
                <span class="skill-tag-premium" *ngFor="let tag of job.tags">
                    {{ tag }}
                </span>
            </div>
        </div>
    </div>
</div>

<div *ngIf="!job && !isLoading"
    class="h-100 d-flex align-items-center justify-content-center p-5 text-muted opacity-50">
    <p class="small">Offre non trouvée.</p>
</div>