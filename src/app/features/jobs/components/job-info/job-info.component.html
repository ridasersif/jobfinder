<div *ngIf="isLoading" class="h-100 d-flex align-items-center justify-content-center bg-white">
    <div class="loading-state text-center">
        <div class="spinner-border spinner-border-sm text-primary mb-2" role="status"></div>
        <p class="xx-small-text text-muted fw-bold text-uppercase">Chargement de l'offre</p>
    </div>
</div>

<div *ngIf="job && !isLoading" class="job-detail-canvas h-100 d-flex flex-column bg-white">
    <!-- Compact Header Section -->
    <div class="detail-header-slim p-3 border-bottom">
        <div class="d-flex align-items-start gap-3 mb-3">
            <div class="detail-logo-slim shadow-xs">
                <img [src]="'https://api.dicebear.com/7.x/initials/svg?seed=' + job.company_name"
                    [alt]="job.company_name">
            </div>

            <div class="flex-grow-1 min-width-0">
                <div class="d-flex align-items-center gap-1 mb-0">
                    <span class="company-label-slim">{{ job.company_name }}</span>
                </div>
                <h5 class="detail-title-slim">{{ job.title }}</h5>

                <div class="detail-meta-row-slim d-flex flex-wrap align-items-center gap-2 mt-1">
                    <div class="meta-item">
                        <lucide-icon name="map-pin" [size]="12"></lucide-icon>
                        <span>{{ job.location }}</span>
                    </div>
                    <div class="meta-item">
                        <lucide-icon name="clock" [size]="12"></lucide-icon>
                        <span>Posté le {{ (job.created_at * 1000) | date:'dd MMM yyyy' }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Bar Slim -->
        <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex gap-2">
                <button class="btn apply-btn-slim">
                    Postuler
                    <lucide-icon name="external-link" [size]="12"></lucide-icon>
                </button>
                <button class="btn save-btn-slim">
                    <lucide-icon name="bookmark" [size]="14"></lucide-icon>
                    Enregistrer
                </button>
            </div>

            <div class="d-flex gap-1">
                <button class="btn tool-btn-slim" title="Partager"><lucide-icon name="share-2"
                        [size]="14"></lucide-icon></button>
            </div>
        </div>
    </div>

    <!-- Scrollable Content Hub -->
    <div class="detail-body-premium flex-grow-1 overflow-auto scroll-slim p-3">
        <!-- High-Density Insight Badges -->
        <div class="d-flex flex-wrap gap-2 mb-4">
            <div class="badge-v3">
                <lucide-icon name="briefcase" [size]="12"></lucide-icon>
                <span *ngFor="let type of job.job_types | slice:0:1">{{ type }}</span>
            </div>
            <div class="badge-v3">
                <lucide-icon name="zap" [size]="12"></lucide-icon>
                <span>{{ job.remote ? 'Remote' : 'On-site' }}</span>
            </div>
        </div>

        <!-- Job Description Section -->
        <div class="job-article-wrapper mb-4">
            <h6 class="section-title-premium mb-2">À propos du poste</h6>
            <div class="job-rich-text" [innerHTML]="job.description"></div>
        </div>

        <!-- Skills Cloud -->
        <div class="expertise-hub border-top pt-3">
            <h6 class="section-title-premium mb-2">Compétences clés</h6>
            <div class="skills-cloud d-flex flex-wrap gap-2">
                <span class="skill-tag-v2" *ngFor="let tag of job.tags">
                    {{ tag }}
                </span>
            </div>
        </div>
    </div>
</div>

<div *ngIf="!job && !isLoading" class="h-100 d-flex align-items-center justify-content-center p-5 text-muted bg-white">
    <div class="text-center">
        <lucide-icon name="alert-circle" [size]="32" class="mb-3 opacity-25"></lucide-icon>
        <p class="small">Nous n'avons pas pu trouver les informations de cette offre.</p>
    </div>
</div>