<div class="jobs-page-wrapper">
  <!-- Main Grid Container -->
  <div class="container-fluid px-lg-5">
    <div class="row g-0 main-jobs-shell border shadow-sm">

      <!-- Left Sidebar: Job Stream -->
      <div class="col-job-list border-end bg-white">
        <!-- Results Summary -->
        <div class="jobs-meta-header px-3 py-2 border-bottom d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-2">
            <lucide-icon name="list" [size]="14" class="text-primary"></lucide-icon>
            <span class="meta-label">Offres disponibles</span>
          </div>
          <span class="results-pill">{{ filteredJobs.length }} résultats</span>
        </div>

        <div class="job-stream scroll-slim-hidden h-vh-calc">
          <div *ngIf="isLoading" class="p-5 text-center">
            <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
          </div>

          <div *ngIf="!isLoading && filteredJobs.length === 0" class="p-5 text-center text-muted">
            <lucide-icon name="search-slash" [size]="24" class="mb-3 opacity-25"></lucide-icon>
            <p class="small">Aucun job trouvé.</p>
          </div>

          <!-- Job Cards Flow -->
          <button *ngFor="let job of filteredJobs" [class.active]="selectedJobSlug === job.slug"
            (click)="selectJob(job.slug)" class="job-card-slim">

            <div class="card-content d-flex gap-2">
              <div class="logo-box-slim">
                <img [src]="'https://api.dicebear.com/7.x/initials/svg?seed=' + job.company_name"
                  [alt]="job.company_name" class="company-img">
              </div>

              <div class="info-content flex-grow-1 min-width-0">
                <div class="d-flex justify-content-between align-items-start">
                  <h6 class="job-title-text text-truncate">{{ job.title }}</h6>
                </div>

                <p class="company-text mb-0">{{ job.company_name }}</p>

                <div class="location-text d-flex align-items-center gap-1">
                  <lucide-icon name="map-pin" [size]="10"></lucide-icon>
                  <span>{{ job.location }}</span>
                  <span class="dot-separator" *ngIf="job.remote">·</span>
                  <span class="text-success" *ngIf="job.remote">Remote</span>
                </div>

                <div class="card-tags-slim d-flex gap-1 mt-1">
                  <span class="tag-label" *ngFor="let type of job.job_types">{{ type }}</span>
                </div>
              </div>
            </div>
          </button>
        </div>
      </div>

      <!-- Right Pane: Active Job Detail -->
      <div class="col-job-info d-none d-md-block bg-light bg-opacity-10 h-vh-calc">
        <div class="h-100 overflow-hidden">
          <router-outlet></router-outlet>

          <!-- Empty State View -->
          <div *ngIf="!selectedJobSlug"
            class="h-100 d-flex flex-column align-items-center justify-content-center p-5 text-center">
            <div class="empty-detail-state">
              <div class="illustration-box mb-4">
                <lucide-icon name="layout-template" [size]="48" class="text-primary opacity-25"></lucide-icon>
              </div>
              <h5 class="fw-bold text-dark mb-2">Prêt à postuler ?</h5>
              <p class="text-muted small mx-auto" style="max-width: 250px;">
                Sélectionnez une offre à gauche pour consulter les détails complets et envoyer votre candidature.
              </p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
